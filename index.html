<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>W1ntNET — Вход</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="auth-page">
    <div class="glass-card auth-box">
        <img src="icon.png" class="auth-logo"> <h2>W1ntNET</h2>
        <div id="tg-container">
            <script async src="https://telegram.org/js/telegram-widget.js?22" 
                data-telegram-login="W1ntNetAuthBot" 
                data-size="large" 
                data-onauth="onTelegramAuth(user)"></script>
        </div>
    </div>

    <script>
        // Редирект, если уже залогинен
        if (localStorage.getItem('w1nt_user')) { window.location.href = 'indeks.html'; }

        const SUPABASE_URL = 'ТВОЙ_URL';
        const SUPABASE_KEY = 'ТВОЙ_KEY';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        window.onTelegramAuth = async function(user) {
            const { data, error } = await supabaseClient
                .from('profiles')
                .upsert({ id: user.id, username: user.username, avatar_url: user.photo_url })
                .select().single();

            if (!error) {
                localStorage.setItem('w1nt_user', JSON.stringify(data || user));
                window.location.href = 'indeks.html';
            }
        };
    </script>
</body>
</html>
